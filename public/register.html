 <!DOCTYPE html>
<meta charset="utf-8">
<title>注册</title>
<div class="container py-5">
  <div class="card max-w-sm mx-auto p-4">
    <h3>注册</h3>
    <input class="form-control my-2" id="user" placeholder="账号">
    <input class="form-control my-2" id="pwd" type="password" placeholder="密码">
    <input class="form-control my-2" id="email" placeholder="邮箱">
    <div class="d-flex gap-2 mb-2">
      <input class="form-control" id="code" placeholder="验证码">
      <button class="btn btn-sm btn-primary" onclick="sendCode()">发送</button>
    </div>
    <button class="btn btn-success w-100" onclick="reg()">注册</button>
  </div>
</div>
<script>
async function sendCode(){
  await fetch('/api/email/code',{method:'POST',headers:{'Content-Type':'application/json'},
    body:JSON.stringify({email:document.getElementById('email').value})})
}
async function reg(){
  const r=await fetch('/api/register',{method:'POST',headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      username:document.getElementById('user').value,
      password:document.getElementById('pwd').value,
      email:document.getElementById('email').value,
      code:document.getElementById('code').value
    })
  })
  const j=await r.json()
  if(j.code===0) location.href='/login'
}
</script>